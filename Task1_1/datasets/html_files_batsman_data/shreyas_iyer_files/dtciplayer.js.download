var videoObject=window.video_object||{};class PageController{constructor(e){this.onPlayClick=e,this.init()}shouldInitLegacyVideos(){return new Promise((e=>{"complete"===document.readyState&&e(),window.addEventListener("load",(()=>{e()}))}))}initLegacyVideos(){const e=document.querySelectorAll(".legacy-video");e.length&&Array.from(e).forEach((e=>{const t=e.querySelector(".espni-vid-placeholder").getAttribute("data-video-id"),i=e.querySelector(".legacy-video-thumbnail"),o=i.getBoundingClientRect(),n=0!==o.height?o.height:9*o.width/16,a=o.width,s=e.querySelector(".legacy-video-player");s.style.width=a+"px",s.style.height=n+"px",s.style.display="none",i.addEventListener("click",(()=>{stop(),document.querySelectorAll(".legacy-video").forEach((e=>{e.querySelector(".legacy-video-thumbnail").style.display="block",e.querySelector(".legacy-video-player").style.display="none"})),this.onPlayClick(!0,t,`legacy-video-player-${t}`),document.getElementById(`legacy-video-thumbnail-${t}`).style.display="none",document.getElementById(`legacy-video-player-${t}`).parentElement.style.display="block"}))}))}init(){const e=document.querySelector(".main");e&&(e.style.maxWidth="1280px"),document.getElementById("play")&&document.getElementById("play").addEventListener("click",this.handlePlayClick.bind(this),!0),1===videoObject.autoplay&&this.handlePlayClick(),this.shouldInitLegacyVideos().then((()=>{this.initLegacyVideos()}))}handlePlayClick(e){this.onPlayClick(!!e,videoObject.video_id,"player")}}window.PageController=PageController;let hsApiUrl="https://hs-consumer-api.espncricinfo.com";"qa.espncricinfo.com"!==window.ENV_SERVER_NAME&&"test.espncricinfo.com"!==window.ENV_SERVER_NAME||(hsApiUrl="https://qa-hs-consumer-api.espncricinfo.com");let adPagetype=videoObject.pagetype;function _isAndroid(){return window.CleverTap}function _isIOS(){return!!(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.clevertap)}function _isApp(){return _isAndroid()||_isIOS()}adPagetype&&(adPagetype=adPagetype.toLowerCase(),adPagetype=adPagetype.replace(/ /g,""));var HSCI={isApp:_isApp(),isAndroid:_isAndroid(),isIOS:_isIOS(),country:$.cookie("country")||window.country,swid:$.cookie("SWID"),edition:($.cookie("edition-view")||"espncricinfo-en-in").replace("espncricinfo-en-",""),isMobile:window.matchMedia("(max-width: 1023px)").matches,isDesktop:window.matchMedia("(min-width: 1024px)").matches},HSCIUtils={prepareImageUrl:function(e,t){const i=t?`,${t}`:"";if("string"==typeof e){if(e.startsWith("/esci"))return`https://img1.hscicdn.com/image/upload/f_auto${i}${e}`;if(e.startsWith("/db/"))return`https://img1.hscicdn.com/image/upload/f_auto${i}/lsci${e}`;if(e.startsWith("/media/motion/"))return`https://img1.hscicdn.com/image/upload/f_auto${i}/esci${e}`;if(e.startsWith("/videos/"))return`https://img1.hscicdn.com/image/upload/f_auto${i}/mlci${e}`}return e},isVideoWhitelisted:function(e,t){const i=e.countryCodes;return!i.length||i.includes(t&&t.toUpperCase())}};function prepareAnalyticsConfig(e){return{adobeDCR:{APP_MEASUREMENT:{RSID:HSCI.isApp?"wdgwespmaciapps":"wdgespcricinfo,wdgespge"},NIELSEN_DATA:{APP_INFO:{clientId:"us-600140",apid:"PDF51BDE3-B714-47B6-9218-9F91D14D4D76"}}},chartbeat:{domain:"espncricinfo.com"},comscore:{DEBUG:!1},conviva:{customerKey:"fc8dbfdc5da519f576628f619306a357f31bd006",DEBUG:!1}}}function prepareConfiguration(e,t){return{adProvider:{provider:"Google",options:{debug:!0,requestMode:"onLoad",showVpaidControls:!0,timeout:"4000",disableCustomPlaybackForIOS10Plus:!1}},analytics:prepareAnalyticsConfig(e),api:{shieldApiKey:"uiqlbgzdwuru14v627vdusswb"},autoplay:!0,chromeless:!1,disableAdSkip:!0,disableAdobe:!1,disableComscore:!1,disableChartbeat:!1,disableConviva:!1,disableNielsen:!1,enableDRM:!1,disableTimelinePreview:!0,endcard:{timeout:5},language:"en",loop:!1,iphoneplaysinline:!0,volume:{namespace:"ESPNcricinfo",muted:!t.userInitiated},wasUserInitiated:t.userInitiated,social:{url:`https://www.espncricinfo.com/video/${e.video.slug}-${e.video.objectId}`,embedCode:`<iframe width="640" height="360" src="https://www.espncricinfo.com/embed/video/${e.video.slug}-${e.video.objectId}" allowfullscreen frameborder="0"></iframe>`}}}function prepareAnalyticsCustomMetaData(e){const t=e.video,i=e.related,o=i.serieses[0]||{id:"",name:""},n=i.matches[0]||{id:""},a=t.duration,s={ReportSuite:HSCI.isApp?"wdgwespmaciapps":"wdgespcricinfo,wdgespge",CMSID:t.assetId?t.objectId+"-"+t.assetId:t.objectId,ContentDuration:a,DateLastModified:t.modifiedAt,GameID:n.id,League:o.id,PlayerName:"Brightcove-vod",PublishDate:(t.publishedAt.toString()||"").split("T")[0],PublishTime:(t.publishedAt.toString()||"").split("T")[1],ShowCode:t.adShowCode,Site:"cricinfo",Sport:"cricket",VideoID:t.objectId,VideoName:t.title,VideoPlaylist:"",VideoTypeDetail:t.genreName};let d=HSCI.isDesktop?"desktop":"mobile";HSCI.isMobile&&(d=window.innerWidth>window.innerHeight?"Landscape":"Portrait");const r={ContentType:"Video",SWID:HSCI.swid||"",Orientation:d,UserAgent:window.navigator?window.navigator.userAgent:"",PersonalizationTierType:"Not Applicable",Network:"Not Applicable",Segment:"Not Applicable",AirDate:"Not Applicable",AirTime:"Not Applicable",AiringID:"Not Applicable",ProgramCode:t.genreName||"",SportCode:"Not Applicable",ClosedCaptioning:"Not Applicable",AccessMethod:"Not Applicable",AffiliateID:"Not Applicable",AffiliateName:"Not Applicable",PartnerPlayer:"Not Applicable"},c={UNID:"",Site:"cricinfo",TrackingServer:window.s_omni&&window.s_omni.trackingServer,VideoType:"VOD",Edition:`en-${HSCI.edition}`,Language:`en_${HSCI.country}`,Sport:"cricket",Placement:window.s_omni&&window.s_omni.pageName,PlayLocation:window.s_omni&&window.s_omni.pageName,League:window.s_omni&&window.s_omni.eVar21?window.s_omni.eVar21:"no+league",InsiderStatus:"no",LoginStatus:"",Embedded:"no",StoryID:""};return Object.assign({},s,r,c)}function prepareMediaItem(e){const t=e.video;let i=t.playbacks.find((function(e){return"HLS"===e.type}));const o=HSCIUtils.isVideoWhitelisted(t,HSCI.country)?i.url:null;return{id:`${t.scribeMongoId?t.scribeMongoId:t.objectId}`,title:t.title,duration:t.duration,language:"en",source:{url:o,type:"none",variant:null},description:t.summary,authenticationTypes:[],tracking:{nielsen:{type:"content",assetid:t.objectId,program:t.title,title:t.title,clientid:"us-600140",accmethod:"1",length:"35",segA:t.title,segB:"No League",segC:"VOD",isfullepisode:"n",crossId1:"",adloadtype:"2",vcid:"c17"},comscore:{ns_st_cl:35,ns_st_ct:"vc11",ns_st_pr:"VOD",ns_st_ep:t.title,c3:"vod",c6:"Other",ns_st_ti:"*null",ns_st_ia:"*null",ns_st_ce:"*null",ns_st_ci:t.objectId,ns_st_st:"*null",ns_st_en:"*null",ns_st_cn:"1",ns_st_pn:"1",ns_st_tp:"1",ns_st_pu:"ESPN",ns_st_cu:"none",ns_st_ad:"0",ns_st_ge:"Sports"},conviva:{assetName:t.title+" "+t.objectId,duration:t.duration,streamUrl:o,custom:{contentId:t.objectId,assetType:"clip"}},heartbeats:{ContentDuration:t.duration,isFullEpisode:"n",VideoType:"vod",Sport:"Other",League:"No League",ShowCode:"cricinfo_adaptable",CMSID:t.title,PublishDate:(t.publishedAt.toString()||"").split("T")[0],PublishTime:(t.publishedAt.toString()||"").split("T")[1],ExpirationDate:t.expireAt,DateLastModified:t.modifiedAt,VideoTypeDetail:t.genreName}},references:{trackingId:t.objectId,cerebroId:"",videoObjectId:t.objectId},network:null,streamType:"onDemand",supportedMediaCommands:0,images:[{url:HSCIUtils.prepareImageUrl(t.imageUrl||"")}],type:"video",packages:[],tier:null,entityType:"shortform",isSyndicatable:!0,webHref:`https://www.espncricinfo.com/video/${t.slug}-${t.objectId}`}}var currentVideoDetails=null;function onPlayClick(e,t,i){fetch(`${hsApiUrl}/v1/pages/video/video-details?videoId=${t}`).then((e=>e.json())).then((t=>{let o=t;setTimeout((()=>{currentVideoDetails=o;const t={cmsid:"2497009",iu:`/21783347309/espn.cricinfo.com/${adPagetype}`,vid:o.video.objectId},n=prepareConfiguration(o,{userInitiated:e}),a=prepareMediaItem(o),s=new DTCIVideoPlayer(i,{tech:"brightcove",playerId:"Yo9Nxoqv9_default"});s.addEventInterceptor("dtci.adProvider.shouldRequestAds",(function(){return!0})),s.addEventInterceptor("dtci.getNextContent",getNextContent),s.addEventInterceptor("dtci.loaded",(e=>(console.log("dtci.loaded",e),e.source.url||s.error({type:"NOT_FOUND",message:"This video is unavailable."}),e))),s.addEventInterceptor("dtci.updateAnalytics",(function(){s.updateAnalytics({adobeDCR:{ESPN_CUSTOM_METADATA:prepareAnalyticsCustomMetaData(currentVideoDetails)}})})),s.load({advertisingInfo:t,configuration:n,mediaItem:a}),window.player=s}),300)})).catch((e=>{console.log("video start error",e)}))}function stop(){this.player&&(this.player.unembed(),this.player=void 0)}function getNextContent(e){return fetch(`${hsApiUrl}/v1/pages/video/next-recent-details?videoId=${e.references.videoObjectId}`).then((e=>e.json())).then((e=>{const t=e;if(!HSCIUtils.isVideoWhitelisted(t.video,HSCI.country))return getNextContent(prepareMediaItem(t)).then((function(e){return e}));const i=this.prepareMediaItem(t);return currentVideoDetails=t,i})).catch((t=>e))}const page=new PageController(onPlayClick);
